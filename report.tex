\documentclass[12pt, twoside]{report}
	\usepackage[margin=1in]{geometry}
	\usepackage[hidelinks, linktoc=all, pagebackref]{hyperref}
	\usepackage{indentfirst}
    \usepackage{subcaption}
   	\usepackage[superscript,biblabel]{cite}
    \usepackage[font=small,labelfont=bf]{caption}
    \usepackage{abstract}
    \usepackage{mathtools}
    \usepackage{mathrsfs}  
    \usepackage{cleveref}
    \usepackage{fancyhdr}
    \usepackage{enumitem}
    \setlength{\parskip}{0.1cm}   
	\setlength{\parindent}{0.7cm}
    \usepackage{graphicx} % Used to insert images
    \usepackage{adjustbox} % Used to constrain images to a maximum size 
   	\usepackage{color} % Allow colors to be defined
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{longtable} % longtable support required by pandoc >1.10
\usepackage{bbm}

\newcommand{\diff}{\,\mathrm{d}} 	
 \renewcommand{\figureautorefname}{Fig.}%
\renewcommand*\thesection{\arabic{section}}
\DeclarePairedDelimiter\bra{\langle}{\rvert}
\DeclarePairedDelimiter\ket{\lvert}{\rangle}
\DeclarePairedDelimiterX\braket[2]{\langle}{\rangle}{#1 \delimsize\vert #2}
\newcommand{\rbrkt}[1]{\left( #1 \right)}
\newcommand{\sbrkt}[1]{\left[ #1 \right]}

\renewcommand*{\backreftwosep}{ and~}
\renewcommand*{\backreflastsep}{ and~}
\renewcommand*{\backref}[1]{}
\renewcommand*{\backrefalt}[4]{%
\ifcase #1 %
\relax%
\or
(referenced on p. [#2])%
\else
(referenced on p. [#2])%
\fi
}

\numberwithin{equation}{section}
\setcounter{tocdepth}{3}

\renewcommand*\thesection{\arabic{chapter}.\arabic{section}}
\lhead[\rm\thepage]{\fancyplain{}{\nouppercase{\sl{\rightmark}}}}
\rhead[\fancyplain{}{\nouppercase{\sl{\leftmark}}}]{\rm\thepage}
\chead{}\lfoot{}\rfoot{}\cfoot{}
\pagestyle{fancy}

\title{Reverse engineering of the Xmon qubits}

\graphicspath{{Pictures/}, {MIPT NIR presentation/Pics/}}


\begin{document}
\maketitle
\tableofcontents

%\input{report_theory}


%\input{report_experimental_methods}

\chapter{Methods}

In this chapter we will discuss the methods and equipment that were used to engineer and perform the experiments presented in the following chapter. During my Master's course the main activities that I was undertaking were (in the chronological order):
\begin{itemize}
\item designing chips for investigating Q-factors of superconducting CPW resonators
\item designing chips with cQED systems based on transmons
\item improving experimental setup at RQC (design of PCBs, extending fridge capacity, developing software)
\item studying the Q-factors of resonators made of different superconductors
\item spectroscopy of the cQED samples
\item building a time-domain setup for XY-control and dispersive readout of a single qubit
\item time-resolved measurements
\end{itemize}  

Most of the spectroscopy was done in Institute of Solid State Physics in the Russian Quantum Center (RQC) lab and the time-resolved experiments were performed in the Artificial Quantum Systems Lab at Moscow Institute of Physics and Technology. Therefore, the setups in these two places will be used to illustrate the corresponding type of the experiment. 

First of all, some words about EM-simulations and the process of the chip design will be said, concerning both qubits and resonators. Then, the resonator measurement technique will be shown. Finally, we will turn to the qubit measurements, firstly, showing the spectroscopic part and, secondly, elaborating on the time-resolved techniques.

\section{Engineering of the samples}

\subsection{Designing CPW resonators}

\begin{figure}[t]
\includegraphics[width=\textwidth]{resonators_design_perspective}
\caption{Design perspective for the resonator samples that were studied. All resonators had the center strip width of 7 $\mu$m and the coplanar gaps of 4 $\mu$m. \textbf{(a)} Initial design, 10$\times$5 mm$^2$. Six resonators are located near the feedline, with and without an IDC at the open end (used to couple to the transmons in cQED). The asymmetric contact pad configuration was chosen to be compatible to the PCBs which were available at that moment. Resonant frequencies were non-uniformly distributed from 6 to 8.6 GHz. External quality factors were calculated to be around 6000 based on simulated transmission data. \textbf{(b)} Second version of the design. The main differences are the doubled number of the resonators on the chip (to gather more accurate statistical data) and the $Q_e$ increased up to $10^{5}$ (to facilitate the extraction of the $Q_i$ for the fitting algorithm). The frequencies were uniformly distributed from 6 to 8.2 GHz. Also, a border to simplify cutting the chips out of the waver and an ID-label to help distinguish between the samples were added. \textbf{(c)} Third iteration of the design with 24 resonators. Parameters are the same as for the second version, but the size was increased, and the contact pads adapted to the 10$\times$10 mm$^2$ PCBs.}
\label{fig:resonators_design_perspective}
\end{figure}

The CPW resonators that I wanted to use are the $\lambda/4$-type ones, coupled to the feedline as shunts (notch-type). During the 2 years of my work I have gone through just three design versions for the samples with almost no change for the geometries of the individual resonators. This is very important: we were studying the influence of the fabrication process on the quality factors, and thus to have consistent results between different samples and to have the right to compare them one with other, at least their in-plane geometries had to be identical. The designs that were used are presented in \autoref{fig:resonators_design_perspective} in the chronological order. 

The first design was fledgeling, yet already included a lot of work and formed a great foundation for the future developments. It was already heavily simulated, allowed to test experimentally the semi-analytic formula that estimates the ``claw''-coupler influence on the resonance frequency, to test the simulated coupling Q-factors, etc. However, the main feature behind it, which was at that time a breakthrough for me and my group in Russia, was that no hand-drawing at all had been involved in creating it. In contrast, it was fully parametrized and programmed using the macro API of the \textit{LayoutEditor} EDA software. This technique of coding the design, though tedious in the beginning, allows in the long run to make such complex changes to the scheme which otherwise would require redrawing everything from scratch. Moreover, the algorithm, once done correctly and debugged, will make no mistakes which are inevitable when the blueprints are modified by hand. Finally, the basic structures and boolean strategies between layers that were implemented to create that first chip are still being reused and extended by me and other people in the group, which means no extra unnecessary work is done. I would like to thank JÃ¼rgen Lisenfeld from Karlsruhe Institute of Technology for showing me this method and saving days of my life from being wasted on redrawing and checking designs for errors after any change.

The  second design was mostly the same as the first one to ensure consistency between the experiments. It was embellished with a border of width equal to the half thickness of the diamond saw blade (50 microns) to facilitate dicing of the wafers and a label with a unique identifier for each sample. The external quality factors were increased up to $\approx 10^{5}$ for the resonators in this design by moving them further away from the feedline. This helps to find the internal Q-factors more accurately since the fitting algorithm, which will be described further in the text, finds $Q_e$ and $Q_l$ from the data, and then calculates the remaining factor from these two values (recall equation \eqref{eq:qfactor} from chapter 1). If the internal Q-factor is much higher than the external one, then $Q_e$ and $Q_i$ are nearly the same, and the error for the $Q_i$ may become large. To avoid such situations, $Q_e$ was made slightly higher than the average measured $Q_i$. The number of the resonators was increased to 12 to increase the statistical sample and to be more confident in the obtained results.

The third design was filled with 24 resonators to increase the statistical accuracy even more. Otherwise, it was quite the same as the previous one.

\subsection{Simulation of CPW resonator response}

\begin{figure}[t]
\centering
\includegraphics[height=0.4\textheight]{sim_res_S21}\quad \includegraphics[height=0.4\textheight]{res_response}
\caption{Simulated $S_{21}$ parameter (left) and electrical in-plane current density (right) for a real design. The modelling was done in \textit{Sonnet Suite} 2.5D FEM software designed especially for simulating such planar structures. By fitting the complex curve, which is ideally a circle, the frequency and the Q-factors of the resonance may be extracted.}
\label{fig:sim_res_s21}
\end{figure}

Having the design, it is possible to directly import it into the EM-simulation software. \textit{Ansoft HFSS} is usually used for full 3-dimensional analysis, though for S-parameter computation a 2.5D-solver \textit{Sonnet Suite} is usually enough. The Sonnet simulation engine \textit{em} models the structure by placing it in a full metal box between two dielectric layers of given thickness and relative permittivities $\varepsilon_{1,2}$. The S-parameters are extracted by placing \textit{ports} between the ground and the electrode on which we want to put or measure the voltage, and solving the Maxwell equations in frequency domain. 

Typical results for such simulation cab be observed in \autoref{fig:sim_res_s21}. The complex $S_{21}$ parameter is calculated for the ports at the feedline for each frequency. To find a single resonator response in the vicinity of it's resonance frequency, Sonnet adaptive solver usually needs three frequencies at which it performs the full solution. Then it interpolates the S-parameters for the resting points and yields smooth curves which can be fitted to find the properties of the resonator under study. This interpolation is rather accurate, and thus it is practical to put a larger number of points to be interpolated so that extraction of the parameters may be done after a single run without the need of several zoom-in simulations.

Another observation for the Sonnet solver is that it gives a noticeably non-circular but rather flattened elliptical response on the complex plane around the resonant frequency when the loss is introduced into the dielectric layers; it produces a non-ideally circular response when there is no loss at all, too. That means it is not possible to find the internal Q-factor from the simulation, since it is defined exactly by the area that loses its shape. It is not clear why this is the case, as long as in the experiment the curves show such flattening only when non-linear effects come to play.\cite{astafiev2010}

The EM-simulations are quite heavy when large curved structures are considered. To perform a simulation like one shown in \autoref{fig:sim_res_s21} in an hour, it takes several gigabytes of RAM and two Intel Xeon E5-2670 processors. This lead to development of different analytic models for estimating the external Q-factors and coupling capacitances of such structures; however, we prefer just to use crude power.

\section{Experimental setup and equipment in RQC lab}
 

\begin{figure}[h!]
\centering
\includegraphics[width=\textwidth]{BF_for_albmstu1}
\caption{Example configuration of the 15 mK stage of the BF LD 250 fridge in the RQC lab at ISSP with three samples installed (with false colors added). \textbf{(a)} Front-bottom view of the 25 mK flange. Cyan color highlights the cylindric cryoperm shield inside which the sample holder resides. \textbf{(b)} Back view, violet color shows the circulators with a thick copper wire wrapped around them for thermalization. \textbf{(c)} Front-top view, where the 2-channel  microwave switch is shown (magenta) and the hybrid coupler (blue, left in true color) used to measure several samples using only one low-noise HEMT amplifier. \textbf{(d)} Side view, the two unshielded sample holders similar to the one concealed under the shield from (a) are shown in yellow.}
\label{fig:configuratio_photo}
\end{figure}

\begin{figure}[h!]
\centering
\includegraphics[width=.8\textwidth]{setup}
\caption{Schematic of the example configuration shown in \autoref{fig:configuratio_photo}.}
\end{figure}

\section{Two-tone spectroscopy}
\label{sec:2tone}

This type of measurement is conducted with an additional microwave tone from the microwave source, which induced the transitions from ground state of the system to higher levels and transition frequencies from there then are being probed by the VNA. Practically this is realized by setting the VNA to measure single point at the shifted resonator  frequency $\omega_r + \chi_0$ (see \autoref{fig:diagram}). This results in a low transmission as photons get absorbed by the system. Then the qubit is biased, and the frequency on the $\mu$-wave source is swept through some values at each given bias. When the frequency of the latter coincides with some allowed transition frequency of the system at given bias, the system leaves its ground state, and the VNA is not probing a correct transition frequency any more. For example, if second tone has induced qubit $ge$ transition, the correct resonator frequency would be $\omega_r + \chi_1$ and the lowest transmission will be observed there (see \autoref{fig:diagram} again). Thus, at $\omega_r + \chi_0$ where the VNA is measuring the transmission would become higher than it was when the second tone missed the $ge$ transition. 

In reality the situation is a bit more complicated as long as constant microwave tone induces Rabi oscillations between levels if it is resonant with the corresponding transition and after all the VNA will be probing transitions from an incoherent mixture of states (i.e. $\hat \rho = \frac{1}{2} [\ket{0, g}\bra{0,g} + \ket{0, e}\bra{0,e}]$) which depends on the drive strength; however, the transmission still ends up being higher when the second tone induces transitions from ground state. All said above can be applied also to the transmission phase, however the phase at resonance will become either higher of lower depending on the direction of the resonance shift as long as the phase behaves linearly around the resonance. It is thus much more sensitive when the width of the resonance peak is larger than the dispersive shift. 

It is possible to easily extract the linewidth of the qubit which was described in Section \ref{subsec:linewidth} if the resonator linewidth is larger than the dispersive shift. This can be done by setting the VNA frequency to the point of smallest transmission and studying the phase data. The phase will be a linear function of the frequency near this point, and the frequency, in its turn, will be a linear function of the population of the excited state. This means that the width at the half maximum of the 2-tone peak will be same as the width of the peak of the population. If, in contrast, the resonator linewidth is smaller than the dispersive shift, it would be necessary to extract the frequency of the resonator for each point and then plot it against the 2$^{\text{nd}}$ tone frequency to preserve the linearity and measure the linewidth correctly.

This method works well in the dispersive limit when the qubit-resonator detuning $\Delta_\omega = \omega_r - \omega_{ge}$ is large compared to the coupling strength $g$.

%\input{report_experimental_results}

\appendix
\renewcommand*\thesection{\Alph{chapter}.\arabic{section}}

%\input{report_pure_dephasing}

%\input{report_efficient_num_method}


\bibliographystyle{ugost2008}
\bibliography{report.bib}
\end{document}
