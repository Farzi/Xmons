/*

    XMon qubit. Anchor point is on the protect of the arm towards the resonator.

*/



point addXmon(cell* curCell, point anchorPoint, string direction) {

    point cursor;
    cursor.set(anchorPoint.x(), anchorPoint.y()-g_q);
    wire(curCell, protect, anchorPoint, "d", arm_len+2*g_q, w_q+2*g_q);
    wire(curCell, M, cursor, "d", arm_len, w_q);

    cursor.set(cursor.x()-arm_len/2-g_q, cursor.y()-arm_len/2);
    wire(curCell, protect, cursor, "r", arm_len+2*g_q, w_q+2*g_q);
    cursor.set(cursor.x()+g_q, cursor.y());
    wire(curCell, M, cursor, "r", arm_len, w_q);

    cursor.set(cursor.x()+arm_len/2, cursor.y()-arm_len/2-g_q);

    rect selection;
    selection.set(anchorPoint.x() - g_q-w_q/2, anchorPoint.y()-2*g_q-arm_len, 
                 anchorPoint.x()+g_q+w_q/2, anchorPoint.y());
    
    rotateSelection(curCell, selection, anchorPoint, direction);
    
    rect selection;
    selection.set(anchorPoint.x() - (arm_len/2+g_q), anchorPoint.y()-arm_len/2-g_q-w_q/2-g_q, 
                 anchorPoint.x()+(arm_len/2+g_q), anchorPoint.y()-arm_len/2-g_q+w_q/2+g_q);
    
    rotateSelection(curCell, selection, anchorPoint, direction);
    point retPoint;
    retPoint.set(0, -arm_len-2*g_q);
    return rotateVector(retPoint, anchorPoint, direction);
}
